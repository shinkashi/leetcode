import { assertEquals } from "https://deno.land/std/testing/asserts.ts";

function numFactoredBinaryTrees(arr: number[]): number {
    const MOD = 10 ** 9 + 7;

    // create factors hash
    const m = new Map<number, [number, number][]>()
    arr.sort((a, b) => a - b);
    const maxNum = arr[arr.length - 1];

    for (let j = 0; j < arr.length; j++) {
        for (let k = 0; k < arr.length; k++) {
            const n = arr[j] * arr[k]
            if (maxNum < n) {
                break;
            }
            let x = m.get(n) || []
            x.push([arr[j], arr[k]]);
            m.set(n, x);
        }
    }

    // console.log(m);

    // count all patterns
    const memo = new Map<number, number>();

    const factor = (i: number): number => {
        const mv = memo.get(i);
        if (mv) return mv;

        const v = m.get(i)
        // console.log("checking", i, "with", v)
        if (v === undefined) return 1;
        let res = v
            .map(vv => factor(vv[0]) * factor(vv[1]))
            .reduce((a, b) => (a + b) % MOD);
        res += 1;
        memo.set(i, res);
        return res;
    }

    let cnt = 0;
    for (let i = 0; i < arr.length; i++) {
        const f = factor(arr[i]);
        // console.log({ num: arr[i], f })
        cnt += f;
        cnt %= MOD;
    }

    return cnt;
};

Deno.test("test", () => {
    const input = [2, 4, 5, 10];
    const output = 7;
    assertEquals(numFactoredBinaryTrees(input), output);
})

Deno.test("test", () => {
    const input = [2, 4, 5, 10, 20];
    const output = 18;
    assertEquals(numFactoredBinaryTrees(input), output);
})

Deno.test("test3a", () => {
    const input = [2, 4, 8, 16];
    const output = 23;
    assertEquals(numFactoredBinaryTrees(input), output);
})

Deno.test("test3", () => {
    const input = [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16];
    const output = 53;
    assertEquals(numFactoredBinaryTrees(input), output);
})

Deno.test("test4", () => {
    const input = [45, 42, 2, 18, 23, 1170, 12, 41, 40, 9, 47, 24, 33, 28, 10, 32, 29, 17, 46, 11, 759, 37, 6, 26, 21, 49, 31, 14, 19, 8, 13, 7, 27, 22, 3, 36, 34, 38, 39, 30, 43, 15, 4, 16, 35, 25, 20, 44, 5, 48];
    const output = 777;
    assertEquals(numFactoredBinaryTrees(input), output);
})

Deno.test("test4", () => {
    const input = [639973773, 696116673, 665364282, 563574, 176991927, 611346247, 824674976, 958661048, 406551412, 359613990, 807082433, 509083882, 552701220, 647173658, 244627910, 373924448, 383386670, 384124460, 735395732, 680094876, 194569873, 993681422, 740151209, 661773786, 338966885, 416267747, 283763421, 49803949, 469044288, 610739166, 644058133, 676870579, 894138612, 116076350, 539079115, 865475480, 514359209, 194505174, 779290522, 337578142, 500565189, 481743554, 958346319, 52322248, 355304280, 878444947, 353258818, 24965320, 474305451, 666283709, 330546379, 178171561, 65305940, 271830224, 969670400, 857505569, 660596376, 598645524, 118019132, 492076935, 418359990, 625276851, 988899040, 951126878, 243497637, 296628754, 856300695, 875082143, 739153153, 882486704, 111987372, 643024712, 207536920, 322582323, 981174199, 948659446, 234335302, 880958871, 918451699, 587789153, 163414229, 253607126, 658503851, 863442744, 412290054, 533649006, 195678413, 964505279, 43190685, 963063834, 771600226, 73023318, 97352194, 92640956, 743971241, 8080348, 502077665, 455160495, 592094422, 858309054, 712274673, 858291423, 938305061, 19451352, 69282834, 945252100, 43292724, 371769564, 851909514, 968521207, 528157636, 205236842, 161672384, 244426553, 898147089, 707379514, 105202766, 946840868, 404013867, 960950027, 780624394, 438112975, 417250269, 927028689, 328260333, 156117678, 748776330, 111080453, 623412578, 785408326, 67185518, 310987548, 445768026, 99160997, 985643008, 882325168, 757870502, 267298185, 916638192, 703792049, 880389271, 329471566, 486847491, 161612543, 971949799, 124438844, 465084350, 151761812, 250102973, 531788261, 951276239, 98866880, 49977464, 693055524, 186136365, 223194520, 526643238, 460157346, 354859345, 233599763, 710724758, 12714706, 205188522, 315147147, 951835737, 411649495, 244918806, 84328943, 286387387, 775847292, 641788591, 843977820, 335032915, 609757418, 760440417, 632779033, 808511619, 253412268, 216152956, 166837540, 27940920, 832660508, 641932436, 920002910, 562936678, 222036415, 469790136, 395259210, 282189301, 904006056, 249982359, 887896986, 333526864, 212331505, 513380061, 714693768, 965800499, 135812506, 835697224, 522607126, 565521744, 400118792, 192378208, 800524908, 1831761, 191683376, 977775661, 206915352, 474912280, 68332914, 716992863, 541320937, 396004169, 975976806, 759238856, 579547153, 336552927, 81517799, 257197070, 113397967, 343329845, 820374685, 394992577, 399391816, 590862216, 856483853, 812435493, 680234594, 342716223, 82923098, 804156744, 978855881, 143117801, 590162140, 894288463, 3072017, 181053880, 363307758, 365884339, 658021986, 495221259, 473252930, 444807895, 262795810, 944085760, 939934251, 557060489, 782859925, 309552274, 137239627, 873934328, 446436782, 94184428, 634484505, 500253600, 35040509, 678491208, 394247299, 535277149, 454891746, 537549288, 833815102, 652914334, 486171619, 287198824, 306346724, 39050905, 163453481, 118987882, 867810594, 410781214, 624020741, 631087071, 585836361, 556469955, 881585577, 346231588, 646379276, 418702385, 558431564, 763253968, 764308805, 515328611, 875392363, 148764442, 741819111, 342278498, 526537864, 561156514, 454425467, 627868197, 647452459, 913674989, 591460985, 800383998, 578935207, 862999831, 967011791, 444808368, 43418294, 64040948, 591567495, 373548421, 643778615, 843913586, 133731208, 48878531, 433699419, 353927624, 753533317, 393424820, 709767971, 576151294, 200857089, 778639112, 456283313, 666063722, 969612229, 986266401, 348413763, 655847124, 540309609, 328118729, 183375267, 454397165, 929553047, 513177212, 624672022, 170194632, 619891362, 428202852, 448804250, 312578019, 143828009, 149007761, 437511302, 683053165, 736803735, 647180617, 856465731, 170745203, 56434685, 176604637, 505596581, 991047495, 251227382, 919339389, 733253987, 14374261, 299931267, 534770740, 592883029, 141512658, 425682802, 323419360, 768860943, 828475567, 16953835, 526297200, 191301742, 19868132, 335450941, 502609985, 987185726, 105170022, 651467227, 277349947, 391632379, 989480117, 194022190, 190060976, 912551988, 285563142, 414710659, 458423435, 711036336, 478068836, 939806414, 873409043, 612632044, 723239037, 50329378, 51163204, 220182873, 228267758, 521582430, 176816890, 546003498, 967167537, 439502563, 754744936, 280961560, 122080086, 173746412, 572942702, 641733999, 512168771, 432607143, 38042021, 822204364, 787926683, 565867196, 984330526, 570400493, 582214163, 520069884, 954786329, 613027213, 728591292, 661150106, 80411516, 556093770, 994205339, 649606660, 191218144, 138963960, 89885437, 137622486, 331362759, 153492, 486335901, 597999622, 789410770, 329572799, 617494798, 63516937, 607764912, 154852321, 993860955, 307450857, 223939992, 986328795, 336416864, 124305001, 289526008, 424181552, 312429599, 32560773, 411863250, 349261208, 605257929, 596430033, 108687637, 75734224, 294016117, 639746147, 999083694, 456201985, 733431275, 83652446, 965429424, 79859751, 341034275, 670564730, 628746910, 574229831, 590956612, 388606267, 337571803, 178382660, 138262112, 517901516, 40013786, 679907597, 997702909, 503556260, 115240772, 570430701, 663701787, 510578763, 765665817, 334833119, 419109261, 751652605, 151372896, 943219311, 301742647, 125703470, 100196400, 842701903, 696079727, 995638167, 954854366, 359736112, 303396878, 233292903, 641445244, 376901972, 307315483, 297205255, 560656072, 771479981, 690950536, 454639007, 964662910, 743626472, 723197485, 330278876, 178930128, 675410100, 676345465, 37300668, 536885911, 523980652, 747444806, 747458754, 538904026, 712474466, 703722789, 84698037, 855642148, 161452515, 995432916, 203585880, 538161211, 499610998, 464046783, 790538306, 852996203, 389329605, 667193768, 294146320, 383550154, 362756799, 538426913, 743097875, 798399310, 503876213, 818971785, 91826772, 432647343, 58668959, 845509827, 122879625, 965264036, 787656264, 149454478, 908486460, 113188928, 259866936, 562373446, 60865064, 53052431, 358298461, 412202002, 331908377, 269183322, 481698510, 573594448, 948063517, 77665181, 610246737, 8076982, 381684026, 376214980, 620147839, 916431458, 761808692, 405898069, 804431854, 412555761, 346976732, 176551595, 673520351, 365759190, 519935652, 384799658, 906981533, 561495304, 214955608, 735763207, 104767376, 253529626, 188295411, 531129778, 409981651, 518055737, 468510401, 817002043, 764036678, 929586376, 511990030, 438635671, 5122923, 538062820, 154806585, 733224818, 547016812, 617565232, 710876704, 189336145, 373209986, 12332977, 485315536, 331406241, 614198169, 416258315, 731716499, 226537274, 158495020, 37497869, 210106122, 71319148, 754466502, 597462014, 424472035, 879421403, 150263376, 140144938, 737094283, 83270151, 903712238, 834144918, 158672960, 55019335, 138207630, 956277542, 610402473, 577846269, 89141185, 169236874, 330413728, 198906860, 493447938, 979702586, 223824055, 772764307, 33439285, 669025028, 330675490, 43944452, 493697401, 984582420, 168446670, 541616518, 466488410, 43971471, 57953638, 962955651, 140443198, 920137107, 528465304, 857214426, 546406018, 298209841, 686194994, 410406243, 488016876, 935741307, 910677658, 123364662, 149719057, 740502986, 794414613, 558891729, 463731119, 281755995, 994389160, 863499933, 977238612, 234257474, 142033906, 180639005, 184039225, 4796054, 414875929, 787925637, 484274733, 271526729, 746668710, 225364097, 10746129, 516567093, 139819493, 417782036, 132616824, 68572367, 558881577, 952130436, 792491297, 996118282, 273498678, 55186160, 678742688, 435826723, 713348950, 429368153, 556278586, 670991318, 777039741, 64974095, 608130851, 494656540, 622804037, 495855628, 14733588, 722087369, 936075122, 962309028, 618972651, 469092895, 491740436, 310932273, 760372243, 583642091, 905581507, 140063016, 758312838, 502483028, 251029640, 41225898, 887880058, 911928011, 717927865, 527418545, 347941127, 468146519, 713616279, 755935122, 200007606, 770385161, 554047942, 544693156, 26634770, 867791781, 910842723, 496411355, 418318005, 876645049, 772200012, 720682281, 998191795, 157712138, 395442477, 727315020, 284472889, 646343358, 16249608, 551207070, 326090731, 783854176, 679418573, 788289057, 613177970, 614656770, 508690751, 697604646, 77205436, 409964118, 566832607, 888969498, 467510613, 312719418, 927655297, 431469452, 900245642, 854694554, 152779919, 85961117, 344380664, 217971066, 775656687, 194592993, 508190773, 593215184, 433922779, 968281740, 894615802, 479633713, 882150534, 83642479, 497477911, 806320175, 659868023, 858917214, 384114714, 504027647, 105396328, 841900350, 987220500, 114061268, 552095388, 552589912, 137991939, 629379788, 56932957, 823247023, 343793173, 723001469, 892938796, 861642496, 475136080, 4435518, 929220048, 833580853, 202533280, 286876243, 242001746, 594174310, 235953838, 401336766, 340618472, 435863278, 948882164, 553904895, 755603193, 976928396, 566691536, 891916499, 573735580, 879743741, 325875688, 517083934, 999079086, 116523658, 857002786, 672714223, 319051570, 849451300, 103942201, 626018374, 313934732, 78794005, 497095788, 395683745, 42371215, 175687785, 980424123, 114177006, 703497033, 39035858, 658532848, 594973536, 670094492, 24400936, 412323711, 621772277, 951884601, 341694336, 256826429, 807026169, 41561684, 878628987, 63264495, 290201627, 803149729, 660571623, 736704879, 928391589, 878438154, 916509292, 918447003, 603399991, 690125377, 971980402, 135190519, 472460629, 215450989, 720136911, 289419679, 336676157, 310241199, 581702072, 752032709, 768875976, 478032558, 340278960, 843379181, 437462016, 793296515, 837171662, 405436639, 448803468, 872192298, 854831415, 82600326, 386606727, 576672290, 855352413, 240782632, 186633625, 255433319, 342077145, 956383089, 473344141, 959591284, 856745619, 379901391, 377867616, 777145265, 99738702, 452951450, 642081170, 752376099, 734284506, 713217087, 2290233, 842014576, 311346322, 499232534, 536131554, 927115295, 230027650, 832495086, 216002836, 762487110, 452614989, 515275182, 609003, 879974198, 948061612, 47411286, 197925182, 167602570, 4269458, 815387051, 290975763, 419897081, 872941364, 647273746, 539681373, 651708240, 843989491, 961072276, 69745969, 965725239, 223131015, 282983874, 512292508, 904732030, 994804024, 46750338, 546053364, 893344270, 264221686, 524151731, 301503175, 508132369, 202344295, 229975802, 959357880, 99536748, 759745399, 114187786, 575479562, 794908060, 842010694, 871821538, 967632108, 74511198, 606434350, 950956162, 515208084, 452341476, 521837549, 582528565, 928046098, 381256570, 24228397, 116245923, 315621558, 56343323, 578488351, 286226015, 805749710, 731754106, 902209265, 29612604, 628737382, 16304817, 794393178, 655519208, 632527674, 471506817, 228981426, 821442505, 224671257, 870625321, 462326203, 719965175, 23426363, 92887393, 665302368, 721668367, 511955244, 377300836, 590344377, 723720321, 632035531, 189636013, 530495752, 476532083, 402254418, 212872914, 896408969, 922265989, 431148480, 757816823, 200774249, 573788994]
    const output = 1000;
    assertEquals(numFactoredBinaryTrees(input), output);
})

Deno.test("test5", () => {
    const input = [820405493, 328584463, 256634311, 352758970, 904067863, 303079568, 785158205, 693121840, 449885677, 511606208, 909610468, 595560791, 62946358, 881631143, 277319547, 110948820, 901074512, 228027493, 593820680, 460221520, 492449389, 978822353, 799682701, 604601805, 991931265, 496970272, 987091281, 238789022, 442057444, 483940090, 324722848, 615204236, 338155459, 824638876, 249047516, 857885434, 480329252, 460312517, 760322979, 260554395, 199741982, 860583527, 874782009, 684921745, 9874912, 26252077, 573333268, 608378669, 22602062, 921572582, 931448580, 612263045, 851247326, 806647773, 906512123, 977434433, 193096335, 95472048, 981639014, 918063622, 601170822, 301884526, 553055121, 8285233, 37325497, 640879231, 528833090, 667288415, 759511763, 774428472, 296750575, 646178014, 345995145, 256961919, 877353780, 550872573, 533090871, 874866864, 159982267, 846862815, 491870026, 895866695, 796292048, 255031316, 575463851, 947392404, 31975830, 456484989, 522080080, 882833550, 581652407, 370887536, 95803434, 158969753, 522373642, 45396224, 342327710, 555152094, 102291517, 986975104, 32445874, 703028352, 935451519, 558281818, 831049908, 300369795, 625956251, 284450060, 839699458, 380705523, 942930888, 478484488, 709758729, 683580188, 308310532, 92378018, 488956488, 290284209, 384140314, 247941357, 479144012, 861342318, 527176323, 64565975, 414885500, 78295583, 682936485, 960860375, 131415247, 795819931, 405862491, 276456575, 542806278, 924989787, 885625966, 989360560, 128577306, 962308795, 462776481, 935773721, 886048641, 302317769, 710521096, 454726081, 893119879, 605470636, 524836239, 137532807, 780181002, 3968439, 983996291, 587122741, 323189471, 981003172, 856549988, 601826067, 763369180, 659177220, 469672934, 408207139, 996817860, 47048271, 519578288, 230451757, 600719269, 38001682, 796342243, 723662997, 950000343, 537820094, 108184352, 627940515, 902000735, 268787810, 319654550, 535034852, 136899901, 783189481, 775433455, 107757833, 321990347, 437424656, 123497539, 377426608, 80252486, 808490918, 540681206, 850095533, 923718069, 498250061, 768584197, 795572904, 63330466, 455294361, 447009635, 712346802, 313456177, 315642460, 696228723, 760487625, 69085799, 767445900, 46832519, 735637975, 762586022, 521018561, 478811629, 265492308, 519050082, 668006729, 75213932, 874063370, 76886050, 676368121, 591410865, 246486908, 618742851, 753380410, 719229988, 85679580, 423514387, 787286992, 432517211, 884602588, 347264974, 960072868, 443195567, 317739038, 678695264, 629922650, 744445038, 543406606, 204099720, 485548232, 569523681, 183742387, 874995249, 919446535, 890414702, 318072502, 900948167, 615166633, 62205327, 186990980, 615258491, 95825354, 622218890, 668985342, 234010242, 419387520, 785748907, 177956194, 620285742, 480532558, 329142476, 347390499, 299119439, 541998800, 159993468, 376048917, 747392429, 710452856, 511773915, 974226423, 706027565, 110847534, 788137827, 800324267, 769047925, 903952104, 878741530, 900237540, 853881107, 346338806, 604023373, 192465079, 924068945, 887351485, 286983017, 194952212, 505866789, 801275381, 502597340, 424839379, 193269719, 115539281, 202568276, 122849348, 127582207, 100166896, 675135164, 669111602, 683385448, 680461791, 81356634, 29649404, 579127380, 578248935, 906659054, 817344253, 416487848, 750229846, 441209701, 832027958, 927634351, 307136245, 631230272, 282039710, 387002264, 780060082, 186662907, 402565686, 682131048, 104762741, 191432047, 516772401, 948020460, 169583186, 743307600, 833834608, 236660298, 881777779, 473526166, 684681415, 313188951, 586690231, 881940630, 742986994, 880712190, 947188861, 78590437, 539674281, 626887498, 187523412, 614876105, 349469177, 407808900, 950295467, 33486108, 529712917, 813733268, 173295371, 946368477, 640448730, 213346902, 597809083, 813723622, 274546015, 519535820, 977695811, 315462313, 416814810, 922366583, 677409078, 939326232, 873148049, 667805289, 79330914, 683439801, 590079830, 123330183, 464946358, 807759911, 277898703, 778673872, 852620522, 501033743, 799000382, 485740594, 124346426, 933457136, 156808284, 189043288, 667618243, 765409908, 891713046, 364191704, 920062739, 285606750, 16413165, 234261744, 466647962, 55170234, 489117958, 490447633, 748221043, 968370015, 414616873, 182799031, 199326587, 923407746, 703819922, 540007261, 491209796, 90042085, 54046635, 565895163, 855899946, 680690616, 998848808, 472385218, 570297133, 579429455, 109400152, 507994450, 671316857, 899530031, 631744449, 308990577, 28357042, 201025030, 674825858, 456186438, 816633502, 730845087, 505857967, 837852771, 808307827, 741285777, 706559561, 172463002, 762256352, 522878986, 757560022, 507904056, 135899098, 659085900, 213172902, 549634478, 426888416, 968121377, 990359892, 884054863, 745331084, 230691766, 515385807, 542327926, 538996317, 663149043, 783592825, 740048339, 176979838, 527090982, 666971685, 157469244, 790212337, 474078040, 434108239, 602651757, 484812863, 214657842, 154173526, 216340523, 170028325, 435101645, 368610788, 122759895, 41204656, 445331767, 372904194, 903749994, 687217037, 894574981, 618926267, 111870873, 218838443, 193267727, 985965955, 11066716, 621103991, 797911973, 334170198, 732217895, 33398979, 568497710, 192784753, 866915821, 259089827, 15902587, 770148746, 236118030, 856184351, 426136903, 72178411, 706550026, 487789134, 133559625, 523100392, 495368580, 219229584, 714875685, 14625524, 958520714, 446000520, 549533484, 92896351, 649267089, 282403019, 758381897, 909018848, 470520493, 97140491, 623796382, 460375041, 308334602, 62354698, 321794506, 732113856, 298228167, 503688443, 379006120, 313759014, 618104377, 246161849, 815502984, 244821956, 94817923, 1007046, 109003604, 678370657, 392689051, 574321629, 808513378, 321036776, 521985293, 505832425, 328406537, 946617148, 734136102, 352567382, 338401963, 856741764, 349479705, 454812492, 933986218, 874254532, 345054817, 816171412, 925982917, 761184502, 129196101, 98746822, 908830270, 705930364, 204326996, 14975977, 862647910, 521153606, 874919428, 147896020, 496496651, 284498566, 164087669, 366515875, 1343654, 100560128, 267597025, 841374109, 417193598, 54121040, 657390251, 636047524, 442309712, 863262266, 678177313, 619275152, 191500589, 407957810, 195827305, 901588834, 346507205, 201007009, 945287781, 840452167, 538708867, 6420140, 291786648, 487947777, 346048538, 694570427, 658439554, 83710320, 477258503, 728694097, 711442909, 26138319, 629210339, 648518261, 240781743, 390161104, 326306465, 420939685, 824782284, 112377245, 674606569, 604761528, 689758899, 329377791, 359541131, 561983313, 656446731, 208526898, 272178606, 971816494, 296420375, 185858171, 432561156, 626797438, 738081786, 99853218, 419173799, 572668734, 398268938, 737260533, 723080455, 29260722, 998538801, 129645809, 658799560, 812696530, 833267350, 350882719, 186448232, 701643753, 918835603, 316981604, 134522500, 218381716, 185147503, 186159632, 964591814, 187328176, 197914206, 231945427, 938719419, 668260834, 870877909, 723704501, 382310604, 70062216, 126336312, 611411299, 779711153, 820502807, 648690867, 794093934, 979917870, 578687803, 357578941, 7901364, 608404135, 129240271, 334163583, 323347279, 147891840, 116090623, 348806141, 870902525, 869805877, 765262902, 833726883, 104894402, 578512434, 349733094, 970648873, 689395941, 825769204, 278015090, 37687163, 475234920, 592577755, 963176880, 599756686, 109659376, 500795250, 917483319, 423592804, 191082099, 171730514, 245950681, 645976410, 21511750, 251615322, 566596133, 359014807, 443596700, 551170080, 843274995, 68790450, 135541795, 725412657, 985451847, 336300314, 958368861, 585396319, 641589903, 33207072, 129858370, 148347171, 347899801, 607129156, 495137711, 794301730, 594362903, 462717368, 708969018, 45260287, 497894730, 734951236, 21057356, 682987441, 872278382, 213686825, 570301643, 29630065, 645176153, 557716789, 452835051, 501155486, 889606349, 135610634, 144909566, 709060900, 245944495, 495918066, 724241267, 344809282, 961068346, 900469376, 119803250, 849085452, 897727010, 77904130, 656194655, 120494975, 850014841, 225369449, 225251133, 220578396, 855300476, 885855307, 373686115, 674379911, 531622982, 644871113, 887939173, 598851125, 814894184, 141687210, 519818338, 942643209, 414267577, 944310607, 628091289, 143089275, 474131866, 215756835, 200116603, 785791210, 323245796, 911806412, 901737679, 929452610, 806551850, 292812694, 840962996, 560994796, 620847955, 774652691, 745624937, 956399543, 863665447, 330750072, 120248428, 712786270, 857173442, 93292028, 685728293, 94050285, 71364678, 641440031, 799787471, 231370351, 619511764, 71762418, 949998664, 231764234, 179051642, 671518903, 596035126, 598127170, 446996876, 103551896, 461880158, 896521245, 938745517, 802301139, 19114290, 228711685, 68280832, 842567174, 355507878, 945733317, 73920840, 779492039, 629904695, 911882411, 749398718, 38196679, 770498433, 713561766, 101075601, 426834800, 845098717, 101472749, 333216277, 731315775, 998163420, 379762822, 431908670, 664300437, 489817427, 210393061, 683292097, 928218053, 679608977, 663291066, 523027552, 941195170, 76054738, 163811195, 142716320, 691592790, 126234135, 409959611, 810741875, 212724097, 45340925, 127816808, 772912535, 354863141, 658380187, 749240213, 813114885, 751330324, 588897589, 224519488, 227844587, 963043094, 506064211, 987730325, 610389428, 183606770, 587225913, 424305877, 867771836, 580084580, 426028717, 667449438, 22223374, 779752720, 37166776, 22334463, 905966471, 880324113, 230133209, 203317125, 710600742, 381844616, 354715626, 442038216, 512799329, 819465847, 250263176, 76240775, 230497850, 936906729, 2002414, 842010363, 342493969, 844418509, 10799920, 236957011, 529926807, 604718589, 954402574, 939776002, 17738468, 89240898, 242863241, 230661480, 112330247, 665127521, 844573935, 494175551, 380447921, 292216596, 247402329, 813807911, 668288740, 767941241, 4000673, 292486048, 971699491, 199524320, 258012395, 754506197, 777832374, 733829948, 898249098, 286133825, 729829851, 608118205, 969574395, 257727380, 935914859, 43484816, 514935550, 258791679, 393109519, 320709758, 236577274, 533085803, 553483120, 212964341, 205990835, 478620820, 152965986, 715701258, 431434296, 837203608, 836676297, 65937777, 320637289, 228300675, 869330050, 169799899, 838900213, 75268272, 220160222, 816815051, 486755785, 473847121, 649000019, 353787659, 526427474, 116448311, 787199445, 540025875, 466279157, 29867994, 305634345, 566230257, 910235570, 218928636, 156353791, 304053339, 101131674, 99473649, 695403656, 423371198, 310502594, 77967335, 163619045, 480245016, 710540930, 258752186, 91245542, 450504415, 172651747, 830953435, 176672914, 85042831, 769853742, 12690518, 24946884, 808758446, 240968880, 12230668, 126738959, 422174738, 649018255, 638054541, 814265036, 228713071, 90911699, 175689310, 484968366, 658106493, 492381692, 962446206, 711316398, 529145963, 526113125, 583379961, 888620877, 688141417, 109880025, 152939931, 235320152]
    const output = 1000;
    assertEquals(numFactoredBinaryTrees(input), output);
})

